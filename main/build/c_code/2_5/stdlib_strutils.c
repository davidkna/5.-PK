/* Generated by Nim Compiler v0.11.0 */
/*   (c) 2015 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_INTBITS 32
#include "nimbase.h"

#include <string.h>

#include <stdio.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef NI Skiptable96721[256];
typedef NIM_CHAR TY98669[6];
typedef NIM_CHAR TY98672[2501];
typedef NIM_CHAR TY98664[3];
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
N_NIMCALL(void, preprocesssub_96727)(NimStringDesc* sub, NI* a);
N_NIMCALL(NI, findaux_96795)(NimStringDesc* s, NimStringDesc* sub, NI start, Skiptable96721 a);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI start_76443, NI last);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI first, NI last);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* s, NI start);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* s, NI first);
N_NIMCALL(NimStringDesc*, nsuformatBiggestFloat)(NF f, NU8 format, NI precision);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING str);
STRING_LITERAL(TMP58, "", 0);
NIM_CONST TY98664 floatformattochar_98663 = {103,
102,
101}
;

N_NIMCALL(void, preprocesssub_96727)(NimStringDesc* sub, NI* a) {
	NI m;
	m = (sub ? sub->Sup.len : 0);
	{
		NI i_96744;
		NI res_96759;
		i_96744 = 0;
		res_96759 = ((NI) 0);
		{
			while (1) {
				if (!(res_96759 <= ((NI) 255))) goto LA3;
				i_96744 = res_96759;
				a[(((NU8)(((NIM_CHAR) (((NI) (i_96744)))))))- 0] = (NI)(m + ((NI) 1));
				res_96759 += ((NI) 1);
			} LA3: ;
		}
	}
	{
		NI i_96755;
		NI HEX3Atmp_96764;
		NI res_96767;
		i_96755 = 0;
		HEX3Atmp_96764 = 0;
		HEX3Atmp_96764 = (NI)(m - ((NI) 1));
		res_96767 = ((NI) 0);
		{
			while (1) {
				if (!(res_96767 <= HEX3Atmp_96764)) goto LA6;
				i_96755 = res_96767;
				a[(((NU8)(sub->data[i_96755])))- 0] = (NI)(m - i_96755);
				res_96767 += ((NI) 1);
			} LA6: ;
		}
	}
}

N_NIMCALL(NI, findaux_96795)(NimStringDesc* s, NimStringDesc* sub, NI start, Skiptable96721 a) {
	NI result;
	NI m;
	NI n;
	NI j;
{	result = 0;
	m = (sub ? sub->Sup.len : 0);
	n = (s ? s->Sup.len : 0);
	j = start;
	{
		while (1) {
			if (!(j <= (NI)(n - m))) goto LA2;
			{
				{
					NI k_96816;
					NI HEX3Atmp_96828;
					NI res_96831;
					k_96816 = 0;
					HEX3Atmp_96828 = 0;
					HEX3Atmp_96828 = (NI)(m - ((NI) 1));
					res_96831 = ((NI) 0);
					{
						while (1) {
							if (!(res_96831 <= HEX3Atmp_96828)) goto LA6;
							k_96816 = res_96831;
							{
								if (!!(((NU8)(sub->data[k_96816]) == (NU8)(s->data[(NI)(k_96816 + j)])))) goto LA9;
								goto LA3;
							}
							LA9: ;
							res_96831 += ((NI) 1);
						} LA6: ;
					}
				}
				result = j;
				goto BeforeRet;
			} LA3: ;
			j += a[(((NU8)(s->data[(NI)(j + m)])))- 0];
		} LA2: ;
	}
	result = ((NI) -1);
	goto BeforeRet;
	}BeforeRet: ;
	return result;
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) ((&(*dest).data[((*dest).Sup.len)- 0]))), ((NCSTRING) ((*src).data)), (NI)((*src).Sup.len + ((NI) 1)));
	(*dest).Sup.len += (*src).Sup.len;
}

N_NIMCALL(NimStringDesc*, nsuReplaceStr)(NimStringDesc* s, NimStringDesc* sub, NimStringDesc* by) {
	NimStringDesc* result;
	Skiptable96721 a;
	NI i;
	NimStringDesc* LOC8;
	result = 0;
	result = copyString(((NimStringDesc*) &TMP58));
	preprocesssub_96727(sub, a);
	i = ((NI) 0);
	{
		while (1) {
			NI j;
			NimStringDesc* LOC7;
			j = findaux_96795(s, sub, i, a);
			{
				if (!(j < ((NI) 0))) goto LA5;
				goto LA1;
			}
			LA5: ;
			LOC7 = 0;
			LOC7 = copyStrLast(s, i, (NI)(j - ((NI) 1)));
			result = resizeString(result, LOC7->Sup.len + 0);
appendString(result, LOC7);
			result = resizeString(result, by->Sup.len + 0);
appendString(result, by);
			i = (NI)(j + (sub ? sub->Sup.len : 0));
		}
	} LA1: ;
	LOC8 = 0;
	LOC8 = copyStr(s, i);
	result = resizeString(result, LOC8->Sup.len + 0);
appendString(result, LOC8);
	return result;
}

N_NIMCALL(NimStringDesc*, nsuformatBiggestFloat)(NF f, NU8 format, NI precision) {
	NimStringDesc* result;
	TY98669 frmtstr;
	TY98672 buf;
	result = 0;
	frmtstr[(((NI) 0))- 0] = 37;
	{
		if (!(((NI) 0) < ((NI) (precision)))) goto LA3;
		frmtstr[(((NI) 1))- 0] = 35;
		frmtstr[(((NI) 2))- 0] = 46;
		frmtstr[(((NI) 3))- 0] = 42;
		frmtstr[(((NI) 4))- 0] = floatformattochar_98663[(format)- 0];
		frmtstr[(((NI) 5))- 0] = 0;
		sprintf(((NCSTRING) (buf)), ((NCSTRING) (frmtstr)), precision, f);
	}
	goto LA1;
	LA3: ;
	{
		frmtstr[(((NI) 1))- 0] = floatformattochar_98663[(format)- 0];
		frmtstr[(((NI) 2))- 0] = 0;
		sprintf(((NCSTRING) (buf)), ((NCSTRING) (frmtstr)), f);
	}
	LA1: ;
	result = cstrToNimstr(((NCSTRING) (buf)));
	return result;
}

N_NIMCALL(NimStringDesc*, nsuformatFloat)(NF f, NU8 format, NI precision) {
	NimStringDesc* result;
	result = 0;
	result = nsuformatBiggestFloat(f, format, precision);
	return result;
}
NIM_EXTERNC N_NOINLINE(void, stdlib_strutilsInit)(void) {
}

NIM_EXTERNC N_NOINLINE(void, stdlib_strutilsDatInit)(void) {
}

